Данный проект является частью статьи … и служит для создания, обучения и использования ансамблей нейронных сетей для аннотации ЭКГ

Для использования проекта необходимы пакеты: tensorflow, keras и BaselineWanderRemoval

Для проведения экспериментов использовался датасет с ЭКГ LUDB http://www.cyberheart.unn.ru/database

В начале работы, нужно прописать в utils.py пути до папки с данными, а так же до рабочих директорий

Для обучения членов ансамбля необходимо запустить train_models.py. После окончания его работы в папке указанной в path_to_ensemble_models будут хранится файлы с обученными моделями, в path_to_ensemble_data - данные, на которых обучалась каждая из них

Для использования обученных моделей для разметки, используется функция ensemble_predict из ensemble/make_ensemble.py, в ensemble/visualisation.py есть функции для визуализации результата, например, draw_one отрисовывает разметку сети и GT поверх ЭКГ

Для создания сети-судьи поверх обученного ансамбля, необходимо использовать функцию train_judge из ensemble/judge.py. Для получения разметки с использованием судейской сети используется функция ensemble_predict_with_judge. Пример использования в main в judge.py

Для оценки результатов можно использовать функцию statistics из metrics.py, которая создаёт таблицу со значениями чувствительности, PPV, средним и дисперсией ошибок. Также есть графический метод оценки результата в файле ensemble.visualisation.py: ranging. При помощи него строится скаттерограмма значений F1 score на каждом из пациентов. 